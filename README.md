# Декодирование голосов ДЭГ

По состоянию на 19:40 20 сентября -- итоговый протокол так и не был залит в систему ДЭГ Москвы.
В публичном блокчейне расшифровано только ~1.3млн голосов из 2млн.

Этот репозиторий призван помочь расшифровать те голоса, которые ещё не расшифрованы системой ДЭГ Москвы.

## Сборка

1. Установите `rustp` чтобы скомпиллировать код: https://www.rust-lang.org/tools/install
2. Соберите код при помощи запуска `cargo`. Перейдите в терминале в папку с кодом и наберите `cargo build`.
3. Для корректной работы на Windows мне пришлось скачать `protoc.exe` отсюда: https://github.com/protocolbuffers/protobuf/releases/tag/v3.18.0 и добавить в переменную окружения Path:
```
$env:Path += ';C:\Users\<USER>\Downloads\protoc-3.18.0-win64\bin'
```
4. Для установки binggen надо указать путь до файла `clang.dll`. Воспользуйтесь инструкцией: https://rust-lang.github.io/rust-bindgen/requirements.html (я clang скачал через инсталлятор Visual Studio).

## Как пользоваться

Для расшифровки своего бюллетеня надо иметь приватный ключ, публичный ключ бюллетеня, nonce и зашифрованное содержимое голоса.
Это всё можно найти, если вы сохраняли хэш своего голоса при голосовании по инструкции от Голоса: https://www.golosinfo.org/articles/145370

Переходите в нерасшифрованную транзакцию и находите в транзации c типом "Приём бюллетеня" `payload`. Вот так он выглядит:
```
payload: {"voting_id":"ea067e1ad71565daff55627e4b35340620d53d644820478ee798e125efe657c2","district_id":205,"encrypted_choice":{"encrypted_message":"ba6a6399e01a6de53ab02a7f0f0c6699ce0cb447c1dabbae06","nonce":"5f5ee156f699024e0931434ff7654b7ff335099f995d9e8b","public_key":"3cb1eda1c7e718cac35a8f920e86a78e2b8d204ad5a586910eeda3ba29d66564"}}
```

Приватный ключ указан ниже на сайте ДЭГ с подписью "ПРИВАТНЫЙ КЛЮЧ ГОЛОСОВАНИЯ:".

Запускаете программу:
```
cargo build
cargo run <приватный ключ> <публичный ключ из payload> <nonce из payload> <encrypted_message из payload>
```

На выходе получаете что-то такое:
```
191550503
```

Это ID кандидата, за которого отдавали голос. В инструкции Голоса написано, как потом проверить имя кандидата с этим ID.